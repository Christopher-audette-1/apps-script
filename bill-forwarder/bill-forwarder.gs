var FORWARD_EMAIL = 'audettebills@qbodocs.com';\nvar LABEL_TO_SEARCH = 'label:[superhuman]-ai-card_receipts';\nvar EXCLUDE_LABEL = 'audette_invoice';\n\nfunction runBillForwarder() {\n  var query = LABEL_TO_SEARCH + ' -label:' + EXCLUDE_LABEL;\n  var threads = GmailApp.search(query);\n  \n  var forwardedLabel = GmailApp.getUserLabelByName(EXCLUDE_LABEL);\n  if (!forwardedLabel) {\n    forwardedLabel = GmailApp.createLabel(EXCLUDE_LABEL);\n  }\n\n  for (var i = 0; i < threads.length; i++) {\n    var messages = threads[i].getMessages();\n    var attachments = [];\n    var fileNames = [];\n\n    for (var j = 0; j < messages.length; j++) {\n      var messageAttachments = messages[j].getAttachments();\n      for (var k = 0; k < messageAttachments.length; k++) {\n        attachments.push(messageAttachments[k]);\n        fileNames.push(messageAttachments[k].getName());\n      }\n    }\n\n    if (attachments.length > 0) {\n      MailApp.sendEmail({\n        to: FORWARD_EMAIL,\n        subject: 'Forwarded Bill (' + fileNames.length + ')',\n        body: 'Attached bills:\n\n' + fileNames.join('\n'),\n        attachments: attachments\n      });\n      threads[i].addLabel(forwardedLabel);\n    }\n  }\n}\n\nfunction createDailyBillForwarderTrigger() {\n  removeBillForwarderTriggers_();\n  ScriptApp.newTrigger('runBillForwarder')\n    .timeBased()\n    .everyDays(1)\n    .atHour(9) // You can adjust the hour as needed\n    .create();\n}\n\nfunction removeBillForwarderTriggers_() {\n  var triggers = ScriptApp.getProjectTriggers();\n  for (var i = 0; i < triggers.length; i++) {\n    if (triggers[i].getHandlerFunction() === 'runBillForwarder') {\n      ScriptApp.deleteTrigger(triggers[i]);\n    }\n  }\n}
